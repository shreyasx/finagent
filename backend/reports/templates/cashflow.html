{% extends "base.html" %}

{% block title %}Cash Flow Analysis - FinAgent{% endblock %}

{% block header_meta %}Period: {{ period }}{% endblock %}

{% block report_title %}Cash Flow Analysis{% endblock %}
{% block report_subtitle %}Period: {{ period }}{% endblock %}

{% block content %}
<div class="summary-box">
    <h3>Cash Flow Summary</h3>
    <div class="summary-grid">
        <div class="summary-item">
            <div class="label">Total Income</div>
            <div class="value positive">INR {{ "%.2f"|format(total_income) }}</div>
        </div>
        <div class="summary-item">
            <div class="label">Total Expenses</div>
            <div class="value negative">INR {{ "%.2f"|format(total_expenses) }}</div>
        </div>
        <div class="summary-item">
            <div class="label">Net Cash Flow</div>
            <div class="value {% if net_cashflow >= 0 %}positive{% else %}negative{% endif %}">
                INR {{ "%.2f"|format(net_cashflow) }}
            </div>
        </div>
    </div>
</div>

{% if monthly_breakdown %}
<div class="section">
    <h2>Monthly Breakdown</h2>
    <table>
        <thead>
            <tr>
                <th>Month</th>
                <th class="text-right">Income</th>
                <th class="text-right">Expenses</th>
                <th class="text-right">Net</th>
            </tr>
        </thead>
        <tbody>
            {% for month in monthly_breakdown %}
            <tr>
                <td>{{ month.month }}</td>
                <td class="text-right">INR {{ "%.2f"|format(month.income) }}</td>
                <td class="text-right">INR {{ "%.2f"|format(month.expenses) }}</td>
                <td class="text-right">
                    {% set net = month.income - month.expenses %}
                    <span style="color: {% if net >= 0 %}#1b8a3e{% else %}#c0392b{% endif %};">
                        INR {{ "%.2f"|format(net) }}
                    </span>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

{% if category_breakdown %}
<div class="section">
    <h2>Category Breakdown</h2>
    <table>
        <thead>
            <tr>
                <th>Category</th>
                <th class="text-right">Amount</th>
                <th class="text-right">% of Total</th>
            </tr>
        </thead>
        <tbody>
            {% for cat in category_breakdown %}
            <tr>
                <td>{{ cat.category }}</td>
                <td class="text-right">INR {{ "%.2f"|format(cat.amount) }}</td>
                <td class="text-right">{{ "%.1f"|format(cat.percentage) }}%</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}
{% endblock %}
